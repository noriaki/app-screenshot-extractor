# 変更履歴

このドキュメントには、App Screenshot Extractorの主要な変更内容が記録されています。

## [2.0.0] - 2025-10-14

### 追加機能

#### 音声・動画統合Markdown記事生成機能

画面録画動画と別録音声ファイルを統合し、スクリーンショットと音声解説を組み合わせたMarkdown記事を自動生成する機能を追加しました。

**主な新機能:**

- **音声認識機能** (`--audio`オプション)
  - OpenAI Whisperを使用した高精度な日本語音声認識
  - タイムスタンプ付きセグメント単位でテキスト変換
  - ローカル実行でプライバシー保護
  - 音声認識結果をtranscript.jsonに保存

- **タイムスタンプ同期機能**
  - スクリーンショットのタイムスタンプと音声セグメントを自動対応付け
  - 最近傍マッチングアルゴリズムによる高精度な同期
  - 5秒の許容範囲内で最も近い音声テキストを選択

- **Markdown記事生成機能** (`--markdown`オプション)
  - スクリーンショットと音声解説を統合したMarkdown記事を自動生成
  - タイムスタンプ付き見出しで構造化
  - 画像リンクと説明文を自動配置
  - 標準Markdown形式で即座に公開可能

- **柔軟な実行オプション**
  - 音声あり/なしでMarkdown生成可能
  - Whisperモデルサイズを選択可能（`--model-size`オプション）
  - 既存のスクリーンショット抽出機能と完全に統合

**技術詳細:**

- 新規コンポーネント:
  - `AudioProcessor`: 音声ファイル処理と認識
  - `TimestampSynchronizer`: タイムスタンプ同期
  - `MarkdownGenerator`: Markdown記事生成

- 依存パッケージ追加:
  - `openai-whisper>=20231117`: 音声認識エンジン

- 出力ファイル:
  - `transcript.json`: 音声認識結果（セグメント、タイムスタンプ）
  - `article.md`: 生成されたMarkdown記事

**ユースケース:**

- アプリ紹介記事の作成: デモ動画と音声解説から即座に公開可能な記事を生成
- ドキュメント作成の効率化: 手動でのスクリーンショット配置とテキスト入力を大幅に削減
- プレゼンテーション資料作成: 動画から構造化されたMarkdownドキュメントを自動生成

### 変更内容

- CLI引数の拡張:
  - `--audio`: 音声ファイルパスを指定（任意）
  - `--markdown`: Markdown記事生成を有効化（任意）
  - `--model-size`: Whisperモデルサイズを選択（デフォルト: base）

- エラーハンドリングの強化:
  - ファイル不在時の明確なエラーメッセージ
  - 動画・音声長さ不一致の警告表示
  - 音声認識失敗時の適切な処理

- 進捗表示の改善:
  - 音声テキスト変換中の進捗バー表示
  - 各処理ステップの開始・完了メッセージ
  - Markdown生成完了時の統計情報表示

### 後方互換性

- 既存のコマンドライン引数（`-i`, `-o`, `-c`, `-t`, `--interval`）の動作は完全に維持
- `--audio`および`--markdown`オプションなしの場合、v1.0.0と完全に同一の動作
- 既存の`metadata.json`フォーマットは変更なし

### パフォーマンス

- 音声認識処理時間: 音声長の約1/7（baseモデル使用時）
- メモリ使用量: EasyOCR + Whisper同時ロード時でも3GB以内
- エンドツーエンド処理時間: 5分の動画+音声で約2分以内

### セキュリティ

- ローカル音声認識: 音声データを外部APIに送信せず、プライバシーを保護
- ファイルパーミッション: 生成ファイルは適切なパーミッション（0644）で保存
- パストラバーサル防止: ファイルパスの検証を強化

---

## [1.0.0] - 2025-10-13

### 初回リリース

**コア機能:**

- 画面遷移検出 (Perceptual Hashing)
- 安定フレーム抽出
- OCRベースUI重要度分析 (EasyOCR)
- 統合スコアリング
- 時間的重複排除
- 4K動画対応
- Apple Silicon最適化

**技術スタック:**

- Python 3.11+
- OpenCV (動画処理)
- EasyOCR (日本語・英語OCR)
- Pillow (画像処理)
- imagehash (Perceptual Hashing)

**出力形式:**

- スクリーンショット画像 (PNG)
- メタデータ (metadata.json)

---

## バージョニング方針

このプロジェクトは [Semantic Versioning](https://semver.org/) に従います:

- **MAJOR**: 互換性のない変更
- **MINOR**: 後方互換性のある機能追加
- **PATCH**: 後方互換性のあるバグ修正
